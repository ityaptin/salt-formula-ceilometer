
{% set server = salt['grains.filter_by']({
    'Debian': {
        'basic_pkgs': ['ceilometer-api', 'ceilometer-agent-central', 'python-ceilometerclient', 'ceilometer-agent-notification', 'python-elasticsearch'],
        'alarm_pkgs': ['ceilometer-alarm-evaluator', 'ceilometer-alarm-notifier'],
        'collector_pkgs': ['ceilometer-collector'],
        'alarm_services': ['ceilometer-alarm-evaluator','ceilometer-alarm-notifier'],
        'collector_services': ['ceilometer-collector'],
        'basic_services': ['ceilometer-api','ceilometer-agent-central','ceilometer-agent-notification'],
    },
    'RedHat': {
        'basic_pkgs':[ 'openstack-ceilometer-api', 'openstack-ceilometer-central', 'python-ceilometerclient'],
        'alarm_pkgs':['openstack-ceilometer-alarm'],
        'collector_pkgs':['openstack-ceilometer-collector',],
        'basic_services':['openstack-ceilometer-api'],
        'collector_services':['openstack-ceilometer-collector'],
        'alarm_services': ['openstack-ceilometer-alarm-evaluator']
    },
}, merge=salt['pillar.get']('ceilometer:server')) %}

{% set agent = salt['grains.filter_by']({
    'Debian': {
        'basic_pkgs': ['ceilometer-agent-compute'],
        'basic_services': ['ceilometer-agent-compute'],
    },
    'RedHat': {
        'basic_pkgs': ['openstack-ceilometer-compute'],
        'basic_services': ['openstack-ceilometer-compute'],
    },
}, merge=salt['pillar.get']('ceilometer:agent')) %}
